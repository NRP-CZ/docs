# InstallFest NRP Invenio

Cíle školení:

* Nainstalovat si invenio
* Vytvořit nový model
* Seznámit se s cmdline nástroji
* Seznámit se s UI konfigurací

Nebudeme dnes řešit:

* Napojení na AAI
* Harvestování do/z repozitáře
* Konfiguraci pro produkční nasazení

## Úvod

TODO: prezentace

## Prerekvizity

Invenio pro svůj běh potřebuje posix systém (linux, macos) a několik závislostí.
Je potřeba mít nainstalované závislosti z [Getting started](/get_started).
TODO: update get_started.mdx

## Instalace

Instalaci zajišťuje skript `nrp-installer.sh`, který stáhnete z githubu a spustíte s názvem repozitáře, který chcete vytvořit. `rdm-12` je aktuální větev podporované verze Invenio. Na konci Q3 se očekává vydání Invenio RDM 13, všechny oborové repozitáře by pak měly začínat s touto verzí.

```bash
cd demo

curl -sSL https://raw.githubusercontent.com/oarepo/nrp-devtools/rdm-12/nrp-installer.sh >nrp-installer.sh
```

```bash
export REPO=$PWD/my-repo

bash nrp-installer.sh $REPO
```

TODO: do generic parameters prihodit support contact? (co se zobrazuje ve footeru?)

```
🎤 Human readable name of the repository
   Demo repository
🎤 Description of the repository
    (Finish with 'Alt+Enter' or 'Esc then Enter')
> My Demo Repository
 
🎤 List of languages to use in the repository,
2 letter code separated by either comma or space
   cs de

...

Your repository is now initialized. 

To test it out, start the repository in development mode
via ./nrp develop and head to https://127.0.0.1:5000/
to check that everything has been installed correctly.

Then add metadata models via ./nrp model create <model_name>,
edit the model and compile it via ./nrp model compile <model_name>.

To generate a default UI for the model, run ./nrp ui detail <model_name>.
```

## První kompilace a spuštění

```bash
cd $REPO

./nrp develop

```

```

Development server is running

1 or server     - restart python server
2 or ui         - restart webpack server
0 or stop       - stop the server (Ctrl-C also works)

```

### Kontrola

Otevřete prohlížeč a zadejte adresu `https://127.0.0.1:5000/`. Měli byste vidět hlavní stránku repozitáře.

## Import počátečních slovníků a dat

Nechte server běžet a v novém terminálu spusťte:

```bash
REPO=....

cd $REPO
source .venv/bin/activate
invenio oarepo fixtures load ./fixtures --verbose
```

V prohlížeči klikněte na `Communities` a ujistěte se, že je tam komunita `Generic`.

## Vytvoření uživatele

Pojďme vytvořit uživatele, který bude vlastníkem komunity `Generic`.

```bash
invenio users create -a -c "manazer@e-infra.cz" --profile '{"full_name": "Velký Manažer"}'

invenio access allow administration-access user manazer@e-infra.cz
invenio access allow administration-moderation user manazer@e-infra.cz
```

```bash
invenio oarepo communities members add generic "manager@e-infra.cz" owner
```

A následně vytvořte uživatele `clen@e-infra.cz` a nastavte mu roli "member" ve stejné komunitě.

### Kontrola

Přihlaste se do repozitáře jako manažer. Měli byste vidět v menu položku `Communities` a v nich možnost vytvářet nové komunity jako manažer. Jako člen tlačítko pro vytvoření komunity neuvidíte.

# Konfigurace UI - Branding

Nyní je možné přizpůsobit základní UI repozitáře formou nastavení loga, výměny textů a barevnosti.

Detailnější dokumentace je k dispozici pod sekci [Branding](https://nrp-cz.github.io/docs/customize/branding/styling)

## Nastavení loga

- Stáhneme si nové logo z [training-assets](./training-assets/my-logo.svg).

- Použijeme následující postup:
https://nrp-cz.github.io/docs/customize/branding/logo

- Aby se změny projevily, je třeba restartovat development server

```
0 or stop
./nrp develop
```

ui konfigurace - how to change logo, colors

# Novy model

TODO: verze do metadat

1. nrp model create

yaml

2. nrp model compile

?? smazat databazi?

2. ./nrp develop

uprava modelu - pridat keywords

nrp model compile

./nrp reindex || drop

./nrp develop a nechat bezet

cmdline client + vytvoreni zaznamu + API

./nrp ui detail model_name

vyzkouset ze se zobrazi detail pro zaznam z api

search ui - pridat keywords

do deposit formu pridat keywords

vyzkouseni "hotoveho" repozitare

preklady ???
./nrp make translations

ccmm
