import { Cards, Callout, FileTree } from "nextra/components";
import { Card } from "@/components/card";

# Front-end Development of NRP Repositories

The following guide provides a comprehensive overview of front-end development for **NRP (National Repository Platform)** repositories. It explains how to build, customize, and maintain the user interface components of NRP-based repository applications.

## Intended Audience

This guide is designed for:

* Developers implementing UI features for their NRP repository instance.
* Core NRP developers and contributors maintaining shared front-end components.

## Frontend Architecture Overview

NRP repositories follow a **hybrid architecture** combining server-side rendering with **Jinja/JinjaX templates** and client-side interactivity via **React**.

| Layer       | Technology         | Purpose                                              |
| ----------- | ------------------ | ---------------------------------------------------- |
| Server-side  | **Python (Flask)** | Flask UI resource view classes responsible for connecting backend data/services with frontend templates & rendering templates  |
| Server-side | **Jinja / JinjaX** | Templating for static content and SEO-friendly pages |
| Client-side | **React**          | Interactive components, forms, and dynamic UI        |

This design provides both **fast initial page loads** (thanks to server-side rendering) and **rich interactivity** (via React).

### Jinja/JinjaX for Record Detail Pages

Record detail pages are rendered using Jinja templates or JinjaX React-like components. These:

* Are processed on the server side.
* Receive data directly from backend UI resource view classes.
* Produce pre-rendered HTML for fast loading and SEO benefits.

### React for Interactive UI Components

React is used wherever the user interacts dynamically with data or state, such as:

* Search and filtering interfaces
* Deposition forms and submission workflows
* Dashboards and widgets
* Interactive data visualizations

<Callout type="info">
React in NRP repositories is not used for full page rendering (as with SPA apps), but rather for **embedding interactive components & React apps** within context of Jinja-rendered pages.
</Callout>

### When to Use Which Technology

| Use Case                         | Technology       | Reasoning                  |
| -------------------------------- | ---------------- | -------------------------- |
| Detail pages with static content | **Jinja/JinjaX** | Fast, SEO-friendly         |
| Interactive elements             | **React**        | State, reactivity          |
| Forms                            | **React**        | Validation, dynamic fields |
| Charts / Dashboards              | **React**        | Interactive data-driven UI |

## Design System

NRP repositories use the **Semantic UI** design system, which ensures visual consistency between NRP-specific and Invenio-provided components.

<Callout type="warning">
While other design systems can be used, maintaining consistent look and feel across the application will require significant customization effort.
Also dependency management may become much more complex, to avoid conflicts.
</Callout>

* **Semantic UI React** (for React components): [https://react.semantic-ui.com](https://react.semantic-ui.com)
* **Semantic UI** (for LESS/CSS and static pages): [https://semantic-ui.com](https://semantic-ui.com)


## Repository Directory Structure

Each NRP repository typically has a structure like this:

<FileTree>
  <FileTree.Folder name="." defaultOpen>
    <FileTree.Folder name="assets" defaultOpen>
      <FileTree.Folder name="less" defaultOpen>
        <FileTree.Folder name="site" defaultOpen>
          <FileTree.File name="..." />
        </FileTree.Folder>
      </FileTree.Folder>
    </FileTree.Folder>
    <FileTree.Folder name="i18n" defaultOpen />
    <FileTree.Folder name="templates" defaultOpen />
    <FileTree.Folder name="ui" defaultOpen>
      <FileTree.Folder name="components" defaultOpen />
      <FileTree.Folder name="mymodel" defaultOpen />
    </FileTree.Folder>
  </FileTree.Folder>
</FileTree>

### Key folders

* **`ui/`** – All front-end related module-scoped code - typically for record models (React, Jinja, webpack configuration).
* **`assets/`** – Global site-wide UI assets, like LESS styles and Semantic UI theme customizations.
* **`templates/`** – Globally shared and Jinja templates, overrides of built-in Invenio templates.
* **`ui/components/`** – Shared components used across multiple record models or other UI modules.
* **`ui/mymodel/`** – Front-end code specific to the `mymodel` record model.

## Record Model UI Directory Structure

Example structure for one specific record model (e.g., `mymodel`):

<FileTree>
  <FileTree.Folder name="ui" defaultOpen>
    <FileTree.Folder name="mymodel" defaultOpen>
      <FileTree.Folder name="semantic-ui" defaultOpen>
        <FileTree.Folder name="less" />
        <FileTree.Folder name="js" defaultOpen>
          <FileTree.Folder name="mymodel" defaultOpen>
            <FileTree.Folder name="forms" defaultOpen>
              <FileTree.File name="index.js" />
              <FileTree.File name="FormActionsContainer.jsx" />
              <FileTree.File name="FormFieldsContainer.jsx" />
            </FileTree.Folder>
            <FileTree.Folder name="search" defaultOpen>
              <FileTree.File name="index.js" />
              <FileTree.File name="ResultsGridItem.jsx" />
              <FileTree.File name="ResultsListItem.jsx" />
            </FileTree.Folder>
          </FileTree.Folder>
        </FileTree.Folder>
      </FileTree.Folder>
      <FileTree.Folder name="templates" defaultOpen>
        <FileTree.Folder name="semantic-ui" defaultOpen>
          <FileTree.Folder name="mymodel" defaultOpen>
            <FileTree.File name="Deposit.jinja" />
            <FileTree.File name="RecordDetail.jinja" />
            <FileTree.File name="Search.jinja" />
            <FileTree.File name="Sidebar.jinja" />
            <FileTree.Folder name="record_detail" defaultOpen>
              <FileTree.File name="banners.html" />
              <FileTree.File name="main.html" />
            </FileTree.Folder>
          </FileTree.Folder>
        </FileTree.Folder>
      </FileTree.Folder>
      <FileTree.File name="__init__.py" />
      <FileTree.File name="webpack.py" />
    </FileTree.Folder>
  </FileTree.Folder>
</FileTree>

### Key files & folders

* **`webpack.py`** – Webpack configuration for this record model's front-end assets. Declares new JS entry points, aliases, and NPM dependencies in Python.
This is how each module contributes its UI assets to the shared resulting build.
* **`__init__.py`** – Python module initializing the record model's front-end UI package. Implements & registers UI resource view classes for server-side rendering.
* **`templates/semantic-ui/mymodel/`** – Jinja templates & JinjaX components specific to this record model (record detail, search page, deposit form). For interactive pages like search & deposit, these templates typically serve as mountpoints for React apps.
* **`semantic-ui/js/mymodel/`** – React components & apps specific to this record model (search results, deposit forms, etc).
* **`semantic-ui/less/mymodel/`** – LESS styles applicable to this record model components & templates.

## What's Next?

The following sections will guide you through specific front-end development topics regarding NRP repositories UI customization.

### Getting Started

<Cards>
  <Card title="Prerequisites" arrow href="/installation#prerequisites">Set up your environment for front-end development</Card>
  <Card title="Run development server" arrow href="/installation/run_instance#run-the-repository">
    Run the repository in development mode with live asset rebuilding
  </Card>
</Cards>

### Branding and Theming

<Cards>
  <Card title="Theming" arrow href="/customize/repository_ui/branding/theme">
    Introduction to Semantic UI theming system.
  </Card>
  <Card title="Styling with LESS" arrow href="/customize/repository_ui/branding/styling">
    How to write, organize & override built-in LESS styles.
  </Card>
  <Card title="Colors" arrow href="/customize/repository_ui/branding/colors">
    Customize color palette of the repository.
  </Card>
  <Card title="Typography" arrow href="/customize/repository_ui/branding/fonts">
    Customize fonts and typography styles.
  </Card>
  <Card title="Copywriting" arrow href="/customize/repository_ui/branding/copywriting">
    Customize static text strings in templates and components.
  </Card>
  <Card title="Image assets" arrow href="/customize/repository_ui/branding/assets">
    How to provide image assets like logos and icons to be used in the UI.
  </Card>
</Cards>

### UI Resource Views

UI Resource classes in Python connect backend service-level data to frontend templates.

<Cards>
  <Card title="Resource views" arrow href="/customize/repository_ui/resources">
    How to use and configure UI resource view classes.
  </Card>
</Cards>

### Jinja Templating

How to create and customize Jinja templates for server-side UI rendering.

<Cards>
  <Card title="Working with Jinja templates" arrow href="/customize/repository_ui/jinja">
    Template inheritance, blocks, filters, and macros.
  </Card>
</Cards>

### JinjaX Components

How to create reusable JinjaX React-like components for use within Jinja templates.

<Cards>
  <Card title="Creating and using JinjaX components" arrow href="/customize/repository_ui/jinjax">
    Reusable component patterns for Jinja templates.
  </Card>
</Cards>

### React Integration

<Cards>
  <Card title="Introduction to React in Invenio" arrow href="/customize/repository_ui/react" />
  <Card title="Developing React components and apps" arrow href="/customize/repository_ui/react/components" />
  <Card title="Integrating React into templates" arrow href="/customize/repository_ui/react/integration" />
</Cards>

### Asset Management

<Cards>
  <Card title="Webpack Configuration" arrow href="/customize/repository_ui/webpack">
    Managing assets and dependencies.
  </Card>
</Cards>

### Internationalization (i18n)

<Cards>
  <Card title="I18n translations" arrow href="/customize/repository_ui/i18n">
    Translating Jinja templates and React components.
  </Card>
</Cards>

### Testing and Debugging

<Cards>
  <Card title="Testing Jinja Templates" arrow href="/customize/repository_ui/testing/jinja" />
  <Card title="Testing React Components" arrow href="/customize/repository_ui/testing/react" />
  <Card title="Debugging Tools and Techniques" arrow href="/customize/repository_ui/testing/debugging" />
</Cards>


### References

* [Invenio Documentation](https://inveniordm.docs.cern.ch/develop/)
* [Jinja](https://jinja.palletsprojects.com/en/3.1.x/templates/#)
* [JinjaX](https://jinjax.scaletti.dev/guide/)
* [React](https://react.dev/learn)
* [Invenio Webpack](https://flask-webpackext.readthedocs.io/en/latest/)
* [Flask](https://flask.palletsprojects.com/en/2.3.x/)
* [Semantic UI](https://semantic-ui.com/)
* [Semantic UI React](https://react.semantic-ui.com/)
