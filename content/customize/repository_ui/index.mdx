import { Cards, Callout, FileTree } from "nextra/components";
import { Card } from "@/components/card";

# Front-end Development of NRP Repositories

The following guide provides a comprehensive overview of front-end development for **NRP (National Repository Platform)** repositories. It explains how to build, customize, and maintain the user interface components of NRP-based repository applications.


This guide is designed for:

* Developers implementing UI features for their NRP repository instance.
* Core NRP developers and contributors maintaining shared front-end components.

## Frontend Architecture Overview

NRP repositories follow a **hybrid architecture** combining server-side rendering with **Jinja/JinjaX templates** and client-side interactivity via **JavaScript** (vanilla JS or React).

This design provides both **fast initial page loads** (thanks to server-side rendering) and **rich interactivity** (via JavaScript).

### UI Modules as Python Packages

<Callout type="warning">
Unlike typical front-end development where everything is an NPM package, in NRP/InvenioRDM repositories UI elements are mostly shipped in **Python packages or modules**, providing both Jinja templates and webpack assets.
</Callout>

UI for NRP InvenioRDM repositories is packaged as Python packages or modules (except for some exceptions like `react-searchkit` and `react-deposit-forms` which are pure NPM packages). Each UI module contains:

* **Server-side assets**: Jinja/JinjaX templates, Flask resource view classes
* **Client-side assets**: JavaScript/React components, CSS/SCSS styles, static assets (images, fonts, etc.)
* **Webpack configuration**: Python files (`webpack.py`) that declare webpack entry points, aliases, and NPM dependencies

This hybrid approach allows:

* Integration between server-side rendering (templates) and client-side interactivity (JavaScript)
* Single distribution for both frontend and backend components of a feature
* Version coupling between Python backend and JavaScript frontend code

When adding UI features, you typically work within a Python package structure, not a standalone NPM package.

### Jinja/JinjaX for Page Rendering

All pages in the repository are rendered using Jinja templates or JinjaX React-like components. These:

* Are processed on the server side.
* Receive data directly from backend UI resource view classes.
* Produce pre-rendered HTML for fast loading and SEO benefits.

More dynamic pages (like search UI and deposit forms) also embed React apps and/or pure JavaScript for enhanced interactivity.

### JavaScript for Interactive UI Components

Client-side JavaScript handles interactive elements. Choose based on complexity:

* **Vanilla JavaScript** - For simple interactions like toggles, form hints, event listeners
* **React** - For stateful interfaces like search, forms, dashboards

<Callout type="info">
JavaScript in NRP repositories is not used for full page rendering (as with SPA apps), but rather for **adding interactivity** to Jinja-rendered pages.
</Callout>

### When to Use Which Technology

| Use Case                         | Technology       | Reasoning                  |
| -------------------------------- | ---------------- | -------------------------- |
| Detail pages with static content | **Jinja/JinjaX** | Fast, SEO-friendly         |
| Simple toggles, menus, form hints | **Vanilla JS**   | Lightweight, no build step |
| Complex search and filtering interfaces | **React** | State, reactivity          |
| Forms                            | **React**        | Validation, dynamic fields |
| Charts / Dashboards              | **React**        | Interactive data-driven UI |

## Design System

NRP repositories use the **Semantic UI** design system, which ensures visual consistency between NRP-specific and Invenio-provided components.

<Callout type="warning">
While other design systems can be used, maintaining consistent look and feel across the application will require significant customization effort.
Also dependency management may become much more complex, to avoid conflicts.
</Callout>

* **Semantic UI React** (for React components): [https://react.semantic-ui.com](https://react.semantic-ui.com)
* **Semantic UI** (for LESS/CSS and static pages): [https://semantic-ui.com](https://semantic-ui.com)


## Repository Directory Structure

Each NRP repository typically has a structure like this:

<FileTree>
  <FileTree.Folder name="." defaultOpen>
    <FileTree.Folder name="assets" defaultOpen>
      <FileTree.Folder name="less" defaultOpen>
        <FileTree.Folder name="site" defaultOpen>
          <FileTree.File name="..." />
        </FileTree.Folder>
      </FileTree.Folder>
    </FileTree.Folder>
    <FileTree.Folder name="i18n" defaultOpen />
    <FileTree.Folder name="templates" defaultOpen />
    <FileTree.Folder name="ui" defaultOpen>
      <FileTree.Folder name="components" defaultOpen />
      <FileTree.Folder name="mymodel" defaultOpen />
    </FileTree.Folder>
  </FileTree.Folder>
</FileTree>

### Key folders

* **`ui/`** – All front-end related module-scoped code - typically for record models or shared components (React, Jinja, webpack configuration).
* **`assets/`** – Global site-wide UI assets, like LESS styles, Semantic UI theme customizations, fonts, graphics.
* **`templates/`** – Site-wide Jinja templates, overrides of built-in Invenio templates.
* **`ui/components/`** – Shared components used across multiple record models or other UI modules.
* **`ui/mymodel/`** – Front-end specific to the `mymodel` record model.

## Record Model UI Directory Structure

Example structure for one specific record model (e.g., `mymodel`):

<FileTree>
  <FileTree.Folder name="ui" defaultOpen>
    <FileTree.Folder name="mymodel" defaultOpen>
      <FileTree.Folder name="semantic-ui" defaultOpen>
        <FileTree.Folder name="less" />
        <FileTree.Folder name="js" defaultOpen>
          <FileTree.Folder name="mymodel" defaultOpen>
            <FileTree.Folder name="forms" defaultOpen>
              <FileTree.File name="index.js" />
              <FileTree.File name="FormActionsContainer.jsx" />
              <FileTree.File name="FormFieldsContainer.jsx" />
            </FileTree.Folder>
            <FileTree.Folder name="search" defaultOpen>
              <FileTree.File name="index.js" />
              <FileTree.File name="ResultsGridItem.jsx" />
              <FileTree.File name="ResultsListItem.jsx" />
            </FileTree.Folder>
          </FileTree.Folder>
        </FileTree.Folder>
      </FileTree.Folder>
      <FileTree.Folder name="templates" defaultOpen>
        <FileTree.Folder name="semantic-ui" defaultOpen>
          <FileTree.Folder name="mymodel" defaultOpen>
            <FileTree.Folder name="record_detail" defaultOpen>
              <FileTree.File name="banners.html" />
              <FileTree.File name="main.html" />
            </FileTree.Folder>
          </FileTree.Folder>
        </FileTree.Folder>
      </FileTree.Folder>
      <FileTree.File name="__init__.py" />
      <FileTree.File name="webpack.py" />
    </FileTree.Folder>
  </FileTree.Folder>
</FileTree>

### Key files & folders

* **`webpack.py`** – Webpack configuration for this record model's front-end assets. Declares new JS entry points, aliases, and NPM dependencies in Python.
This is how each module contributes its UI assets to the shared resulting build.
* **`__init__.py`** – Python module initializing the record model's front-end UI package. Implements & registers UI resource view classes for server-side rendering.
* **`templates/semantic-ui/mymodel/`** – Jinja templates & JinjaX components specific to this record model (record detail, search page, deposit form). For interactive pages like search & deposit, these templates typically serve as mountpoints for React apps.
* **`semantic-ui/js/mymodel/`** – React components & apps specific to this record model (search results, deposit forms, etc).
* **`semantic-ui/less/mymodel/`** – LESS styles applicable to this record model components & templates.

## What's Next?

The following sections will guide you through specific front-end development topics regarding NRP repositories UI customization.

### Getting Started

<Cards>
  <Card title="Prerequisites" arrow href="/installation#prerequisites">Set up your environment for front-end development</Card>
  <Card title="Run development server" arrow href="/installation/run_instance#run-the-repository">
    Run the repository in development mode with live asset rebuilding
  </Card>
</Cards>

### Branding and Theming

<Cards>
  <Card title="Theming" arrow href="/customize/repository_ui/branding/theme">
    Introduction to Semantic UI theming system.
  </Card>
  <Card title="Styling with LESS" arrow href="/customize/repository_ui/branding/styling">
    How to write, organize & override built-in LESS styles.
  </Card>
  <Card title="Colors" arrow href="/customize/repository_ui/branding/colors">
    Customize color palette of the repository.
  </Card>
  <Card title="Typography" arrow href="/customize/repository_ui/branding/fonts">
    Customize fonts and typography styles.
  </Card>
  <Card title="Copywriting" arrow href="/customize/repository_ui/branding/copywriting">
    Customize static text strings in templates and components.
  </Card>
  <Card title="Image assets" arrow href="/customize/repository_ui/branding/assets">
    How to provide image assets like logos and icons to be used in the UI.
  </Card>
</Cards>

### UI Resource Views

UI Resource classes in Python connect backend service-level data to frontend templates.

<Cards>
  <Card title="Resource views" arrow href="/customize/repository_ui/resources">
    How to use and configure UI resource view classes.
  </Card>
</Cards>

### Templating

<Cards>
<Card title="Overview: Jinja & JinjaX" arrow href="/customize/repository_ui/templating">
  Understanding how templates are collected, Jinja vs JinjaX, and page composition patterns.
</Card>
</Cards>

### Jinja Templating

How to create and customize Jinja templates for server-side UI rendering.

<Cards>
  <Card title="Working with Jinja templates" arrow href="/customize/repository_ui/templating/jinja">
    Template inheritance, blocks, filters, and macros.
  </Card>
</Cards>

### JinjaX Components

How to create reusable JinjaX React-like components for use within Jinja templates.

<Cards>
  <Card title="Creating and using JinjaX components" arrow href="/customize/repository_ui/templating/jinjax">
    Reusable component patterns for Jinja templates.
  </Card>
</Cards>

### JavaScript Assets

<Cards>
  <Card title="JavaScript Assets Overview" arrow href="/customize/repository_ui/js_assets">
    Choosing between vanilla JS and React for interactivity
  </Card>
  <Card title="Simple JavaScript" arrow href="/customize/repository_ui/js_assets/vanilla_js">
    Vanilla JS for lightweight interactions
  </Card>
  <Card title="React" arrow href="/customize/repository_ui/js_assets/react">
    React for complex, stateful UI components
  </Card>
</Cards>

### Asset Management

<Cards>
  <Card title="Webpack Configuration" arrow href="/customize/repository_ui/webpack">
    Managing entry points, aliases, and NPM dependencies.
  </Card>
</Cards>

### Internationalization (i18n)

<Cards>
  <Card title="I18n translations" arrow href="/customize/repository_ui/i18n">
    Translating Jinja templates and React components.
  </Card>
</Cards>

### Testing and Debugging

<Cards>
  <Card title="Testing Jinja Templates" arrow href="/customize/repository_ui/testing/jinja" />
  <Card title="Testing React Components" arrow href="/customize/repository_ui/testing/react" />
  <Card title="Debugging Tools and Techniques" arrow href="/customize/repository_ui/testing/debugging" />
</Cards>


### References

* [Invenio Documentation](https://inveniordm.docs.cern.ch/develop/)
* [Jinja](https://jinja.palletsprojects.com/en/3.1.x/templates/#)
* [JinjaX](https://jinjax.scaletti.dev/guide/)
* [React](https://react.dev/learn)
* [Invenio Webpack](https://flask-webpackext.readthedocs.io/en/latest/)
* [Flask](https://flask.palletsprojects.com/en/2.3.x/)
* [Semantic UI](https://semantic-ui.com/)
* [Semantic UI React](https://react.semantic-ui.com/)
