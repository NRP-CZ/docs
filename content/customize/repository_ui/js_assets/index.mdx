import { Callout, FileTree, Steps, Cards } from "nextra/components";
import { Card } from "@/components/card";

# JavaScript Assets

NRP repositories support two approaches for client-side interactivity: **simple/vanilla JavaScript** for lightweight DOM manipulation, and **React** for complex stateful UI components.

## Choosing the Right Approach

All JavaScript in NRP repositories is bundled through Webpack/RSpack (see [Webpack Configuration](/customize/repository_ui/webpack)), regardless of whether you use vanilla JS or React. Start with vanilla JavaScript for simple use cases -- it's easier to implement for lightweight interactions. Introduce React when you need state management, component reusability, or any complex interfaces.

| Scenario | Use |
|----------|-----|
| Simple form validation, toggles, mobile menus | Vanilla JS |
| One-off event listeners (click, scroll) | Vanilla JS |
| jQuery plugins or small interactions | Vanilla JS |
| Complex forms with validation | React |
| State-driven interfaces (filters, tabs) | React |
| Datasets with search/filter/sort | React |

## File Organization

JavaScript assets are organized within each UI module, typically with a nested folder structure that mirrors the module name under `ui/<module>/semantic-ui/js/<module>/`:

<FileTree>
  <FileTree.Folder name="ui" defaultOpen>
    <FileTree.Folder name="mymodel" defaultOpen>
      <FileTree.File name="webpack.py" />
      <FileTree.Folder name="semantic-ui" defaultOpen>
        <FileTree.Folder name="js" defaultOpen>
          <FileTree.Folder name="mymodel" defaultOpen>
            <FileTree.Folder name="detail" defaultOpen>
              <FileTree.File name="index.js" />
            </FileTree.Folder>
            <FileTree.Folder name="search" defaultOpen>
              <FileTree.File name="index.js" />
              <FileTree.File name="filters.js" />
            </FileTree.Folder>
          </FileTree.Folder>
        </FileTree.Folder>
      </FileTree.Folder>
    </FileTree.Folder>
    <FileTree.Folder name="components" defaultOpen>
      <FileTree.File name="webpack.py" />
      <FileTree.Folder name="semantic-ui" defaultOpen>
        <FileTree.Folder name="js" defaultOpen>
          <FileTree.Folder name="components" defaultOpen />
        </FileTree.Folder>
      </FileTree.Folder>
    </FileTree.Folder>
  </FileTree.Folder>
</FileTree>

- **Module folders** - Each UI module has its own `webpack.py` and `semantic-ui/js/` directory
- **`semantic-ui/js/<module>/`** - JavaScript folder named after the module

## Quick Start

### Adding Vanilla JavaScript

<Steps>

1. Create a JS file for your feature in `ui/<module>/semantic-ui/js/<module>/`:

```js
// ui/myfeature/semantic-ui/js/myfeature/home-page-search.js
document.addEventListener('DOMContentLoaded', () => {
  const searchInput = document.querySelector('input.form-control');
  if (searchInput) {
    searchInput.addEventListener('keydown', (e) => {
      if (e.key === 'Enter') {
        window.location.href = `/search?q=${encodeURIComponent(searchInput.value)}`;
      }
    });
  }
});
```

2. Register the entry point in your module's `webpack.py` (see [Webpack Configuration](/customize/repository_ui/webpack)):

```python filename="ui/myfeature/webpack.py"{10}
from invenio_assets.webpack import WebpackThemeBundle

theme = WebpackThemeBundle(
    __name__,
    ".",
    default="semantic-ui",
    themes={
        "semantic-ui": dict(
            entry={
                "home-page-search": "./js/myfeature/search/home-page-search.js",  # ← Add your entry point here
            },
        )
    }
)
```

3. Include the webpack bundle in your Jinja/JinjaX template:

```jinja filename="templates/homepage.html"
{%- block javascript %}
{{ webpack['home-page-search'] }}
{%- endblock %}
```
</Steps>

### Adding a React app

<Steps>

1. Include a `div` with your target id in the Jinja or JinjaX template where you want the React app to appear:

```html
<div id="search-root"></div>
```

2. Create your React app in `ui/<module>/semantic-ui/js/<module>/`:

```jsx
// ui/mymodel/semantic-ui/js/mymodel/search/search.js
import ReactDOM from "react-dom";
import { SearchApp } from './SearchApp';

document.addEventListener('DOMContentLoaded', () => {
  const rootElement = document.getElementById('search-root');
  if (rootElement) {
    ReactDOM.render(<SearchApp />, rootElement);
  }
});
```

3. Register the entry point in your module's `webpack.py` (see [Webpack Configuration](/customize/repository_ui/webpack)):

```python filename="ui/mymodel/webpack.py"{10}
from invenio_assets.webpack import WebpackThemeBundle

theme = WebpackThemeBundle(
    __name__,
    ".",
    default="semantic-ui",
    themes={
        "semantic-ui": dict(
            entry={
                "search": "./js/mymodel/search/search.js",  # ← Add your entry point here
            },
        )
    }
)
```

4. Include the webpack bundle in your Jinja/JinjaX template:

```jinja filename="templates/search.html"
{%- block javascript %}
{{ webpack['search.js'] }}
{%- endblock %}
```

The `webpack` Jinja variable provides access to all bundled JavaScript assets. Use the entry point name (from step 3) with `.js` appended to include the bundle entry.

</Steps>

## Topics

<Cards>
  <Card title="Simple JavaScript" href="/customize/repository_ui/js_assets/vanilla_js">
    Adding vanilla JS files for lightweight interactivity
  </Card>

  <Card title="React Components" href="/customize/repository_ui/js_assets/react">
    Building complex, stateful UI components with React
  </Card>

  <Card title="Webpack Configuration" href="/customize/repository_ui/webpack">
    Managing entry points, aliases, and NPM dependencies
  </Card>
</Cards>
